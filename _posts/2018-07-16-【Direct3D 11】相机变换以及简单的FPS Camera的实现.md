---
layout:     page
title:      相机变换以及简单的FPS Camera的实现
subtitle:   用矩阵进行相机坐标系变换以及实现简单的第一人称射击Camera类
date:       2018-07-20
author:     翼
header-img: image/bg.jpg
catalog: true
tags:
---
## 前言

>以下内容部分参考《3D游戏编程大师技巧》（后面提到会简称《3D》），有所改动，因为我觉得书中有些错误。另外，我写的文章都采用 **左手坐标系**。

## View Frustum
3D场景中的模型都位于世界坐标系中，要观察该3D场景（其实是部分场景），通常会将一个虚拟相机放到世界坐标系中的某一个位置，通过这个虚拟相机观察3D的世界。这个虚拟相机其实就好像我们的眼睛，我们可以控制相机的摆放位置以及拍摄方向，来观察3D世界。相机能观察到的3D场景，最终会被渲染到屏幕上。  

那么怎么确定相机能观察到3D世界的哪些物体呢？  
有了相机的观察方向后，再有一个控制观察范围的3D空间就能达到目标。这个3D空间叫做View Frustum，观察平截头体，简单来说称之为视景体。  

![view frustum](https://raw.githubusercontent.com/ttyrion/ttyrion.github.io/master/image/direct3d/camera/view_frustum.png)  

如上图。  
一台虚拟相机摆放在(*cam_x*,*cam_y*,*cam_z*)处，相机方向(*ang_x*, *ang_y*, *ang_z*)。还有视景体，定义了相机的观察范围。  
视景体由以下四个元素定义：  
1. 水平方向的视野 *FOV_x*
1. 竖直方向的视野 *FOV_y* （**FOV一般在60-130度，实际计算要以弧度为单位**）
1. 近裁剪面 *Z_near*
1. 远裁剪面 *Z_far*  

以上四个量，可以组成一个六面体，好像一个截掉顶端的金字塔，即视景体，包围了虚拟相机可见的范围。不在视景体范围内的，都会被裁剪掉。   
**注意：** 裁剪平面Z_near和Z_far的坐标已经是在相机坐标系了，此时，已经把相机当做原点，相机观察的方向为 **+Z** 。  
有了相机的观察方向和视景体，已经能知道我们能观察到的空间范围了。但是为了实际计算，必须要定义 **相机坐标系**。  
D3D采用左手坐标系：向右为 **+X** 轴， 向上为 **+Y** 轴，垂直屏幕（或纸面）向里为 **+Z** 轴。  
